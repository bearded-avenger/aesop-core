<<<<<<< HEAD
!function(a){tinymce.PluginManager.add("aiview",function(b){function c(a){return a.replace(/(\[aesop_([a-zA-Z_]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z_]+]|\[aesop_([a-zA-Z_]+)\s?([^\[\]]*)])/g,function(a){return d("aesop-component",a)})}function d(a,b){var c=/\[aesop_([a-zA-Z_]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z_]+]/g,d=/\[aesop_([a-zA-Z_]+)\s?([^\[\]]*)]/g,e=/(<\/p>[\s]*<p><\/p>\s<p>)[\s]*$/,f=/(<\/p>[\s]*<p>)[\s]*$/,h=c.exec(b);if(h){var i=g(h),j="string"==typeof i.title&&i.title.length>0?": "+i.title:"";h[3]=h[3].replace(e,""),h[3]=h[3].replace(f,"");var k='<div data-mce-resize="false" data-mce-placeholder="1" data-aesop-sc="'+window.encodeURIComponent(b)+'" class="mceItem aesop-component-long '+a+'"><div class="aesop-component-mask mceNonEditable unselectable" contenteditable="false"></div><div class="aesop-component-bar" contenteditable="false"><div class="aesop-component-controls"><div title="Delete Component" class="aesop-button aesop-button-delete">&nbsp;</div><div title="Clone Component" class="aesop-button aesop-button-clone">&nbsp;</div><div title="Edit Component" class="aesop-button aesop-button-edit aesop-scope-'+h[1]+'">&nbsp;</div><div title="Cut Component / CTRL + ALT + ENTER to Paste" class="aesop-button aesop-button-clipboard">&nbsp;</div></div><span class="mceNonEditable aesop-component-title unselectable aesop-'+h[1]+'-title">'+h[1].replace(/_/g," ")+j+'</span></div><div class="aesop-component-content aesop-'+h[1]+'"><p>'+h[3]+"</p></div></div>"}else{h=d.exec(b);var i=g(h),j="string"==typeof i.title&&i.title.length>0?": "+i.title:"",k='<div data-mce-resize="false" data-mce-placeholder="1" data-aesop-sc="'+window.encodeURIComponent(b)+'" class="mceItem aesop-component-short '+a+'"><div class="aesop-component-mask mceNonEditable unselectable" contenteditable="false"></div><div class="aesop-component-bar" contenteditable="false"><div class="aesop-component-controls"><div title="Delete Component" class="aesop-button aesop-button-delete">&nbsp;</div><div title="Clone Component" class="aesop-button aesop-button-clone">&nbsp;</div><div title="Edit Component" class="aesop-button aesop-button-edit aesop-scope-'+h[1]+'">&nbsp;</div><div title="Cut Component / CTRL + ALT + ENTER to Paste" class="aesop-button aesop-button-clipboard">&nbsp;</div></div><span class="mceNonEditable aesop-component-title unselectable aesop-'+h[1]+'-title">'+h[1].replace(/_/g," ")+j+'</span></div><div class="aesop-end">WcMgcq</div></div>'}return k}function e(a){return a.replace(/<div[^>]+?class="[^"]+?aesop-component-long.*?aesop-sc="([^"]+)"[\s\S]*?aesop-component-content[^>]*?>(.*?)<\/div>[\s]*?<\/div>|<div class="[^"+]+?aesop-component-short.*?aesop-sc="([^"]+)"[\s\S]*?WcMgcq<\/div><\/div>/g,function(a){return f(a)})}function f(a){var b=/<div[^>]+?class="[^"]+?aesop-component.*?aesop-sc="([^"]+)"[\s\S]*?aesop-component-content[^>]*?>(.*?)<\/div>[\s]*?<\/div>/g,c=/<div class="[^"+]+?aesop-component.*?aesop-sc="([^"]+)"[\s\S]*?WcMgcq<\/div><\/div>/g,d=/<div\s*class="clipboardControl[^>]+?><div\s*class="aesop[^>]+>\s*<\/div><\/div>/g;a=a.replace(d,"");var e=b.exec(a);if(e){var f=window.decodeURIComponent(e[1]),g=/\[[^\]]*\]([^\[]*)[^\]]*\]/,h=g.exec(f);return null!=h&&(e[2]=e[2].replace(/^<p>\W<\/p>/,""),f=f.replace(h[1],e[2])),"<p>"+f+"</p>"}if(e=c.exec(a),!e)return a;var f=window.decodeURIComponent(e[1]);return"<p>"+f+"</p>"}function g(a){var b=/\[aesop_([a-zA-Z_]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z]+]/g,c=/\[aesop_([a-zA-Z_]+)\s([^\[\]]*)]/g,d=/<br data-mce-bogus="1">/g,e=/([^\s]+="[^"]+")/g,f=b.exec(a);if(!f&&(f=c.exec(a),!f))return a;for(var g,h=[];null!==(g=e.exec(f[2]));)h.push(g[1]);var i=[];return h.forEach(function(a){a=a.split("=");var b=a[0],c=a[1];c=c.slice(0,-1),i[b]=c.substring(1)}),"undefined"!=typeof f[3]&&(i.content=f[3].replace(d,"")),i}function h(a){"none"!==a.style.display&&(a.style.display="none")}function i(a){"block"!==a.style.display&&(a.style.display="block")}function j(b){window.clipboardSource=b;var c=tinymce.activeEditor,d=c.dom.create("div",{"class":"clipboardControl mceNonEditable unselectable"},'<div class="aesop-button aesop-button-paste mceNonEditable unselectable" title="Ctrl + Alt + Enter to Paste">&nbsp;</div>');c.getBody().insertBefore(d,c.getBody().firstChild),window.clipboardControl=a(d)}function k(){var a=tinymce.activeEditor,b=a.dom.select(".clipboardControl");a.dom.remove(b),delete window.clipboard,delete window.clipboardSource,delete window.clipboardControl}function l(){var a=window.clipboardSource,b=tinymce.activeEditor;b.dom.remove(a),i(window.clipboard),b.execCommand("mceInsertRawHTML",!1,window.clipboard.outerHTML),k()}function m(a){tinymce.activeEditor;jQuery(a.outerHTML).insertAfter(a)}jQuery.fn.setCursorPosition=function(b){return 0==this.length?this:a(this).setSelection(b,b)},jQuery.fn.setSelection=function(a,b){if(0==this.length)return this;if(input=this[0],input.createTextRange){var c=input.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select()}else input.setSelectionRange&&(input.focus(),input.setSelectionRange(a,b));return this},jQuery.fn.focusEnd=function(){return this.setCursorPosition(this.val().length),this},b.onClick.add(function(b,c){if(delete window.ailocked,delete window.aiactive,"undefined"!=typeof a(b.selection.getNode()).parents(".aesop-component")[0]&&(window.aiactive=!0),c.target.className.indexOf("aesop-button-delete")>-1){var d=confirm("Are you sure you want to delete this Aesop Component?");d===!0&&c.target.parentNode.parentNode.parentNode.parentNode.removeChild(c.target.parentNode.parentNode.parentNode),delete window.aiactive,window.ailocked=!0,tinymce.execCommand("mceFocus",!1,b.id)}if(c.target.className.indexOf("aesop-button-edit")>-1){var f=/aesop-scope-([a-z_]*)/,i=f.exec(c.target.className),k=c.target.parentNode.parentNode.parentNode,l=e(k.outerHTML);if(k.setAttribute("id","aesop-generator-editing"),i){a("body").toggleClass("modal-open"),a("body").addClass("modal-updating"),a("#aesop-generator-wrap").toggleClass("aesop-generator-open");var n=".dk_options li."+i[1]+" a";a(n).click();var o=g(l);for(var p in o)"content"===p?a("#aesop-generator-content").val(o[p]):a('#aesop-generator-settings [name="'+p+'"]').val(o[p])}b.selection.collapse(!1)}if(c.target.className.indexOf("aesop-button-clipboard")>-1){var k=c.target.parentNode.parentNode.parentNode;window.clipboard=k,h(k),j(k),b.selection.collapse(!1)}if(c.target.className.indexOf("aesop-button-clone")>-1){var k=c.target.parentNode.parentNode.parentNode;m(k),b.selection.collapse(!1)}}),b.onKeyDown.add(function(b,c){if(delete window.ailocked,13===c.keyCode&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){var d=b.selection.getNode(),e=a(d).parents(".aesop-component");if(a(d).parents(".aesop-component")[0]){c.preventDefault(),c.stopPropagation();var f=a("<p><br/></p>").insertAfter(e);f.uniqueId();var g=f.attr("id"),h=b.dom.select("#"+g)[0];b.selection.setCursorLocation(h)}}c.ctrlKey&&c.altKey&&13===c.keyCode&&(c.preventDefault(),c.stopPropagation(),"undefined"==typeof window.clipboard?alert("Clipboard is empty"):"undefined"!=typeof window.aiactive?alert("Please do not paste into an existing aesop component"):l())}),b.onKeyUp.add(function(b){"undefined"!=typeof a(b.selection.getNode()).parents(".aesop-component")[0]?window.aiactive=!0:delete window.aiactive}),b.on("BeforeSetContent",function(a){a.content=c(a.content)}),b.on("PostProcess",function(a){a.get&&(a.content=e(a.content))})})}(window.jQuery);
//# sourceMappingURL=plugin.min.js.map
=======
!function($){tinymce.PluginManager.add("aiview",function(e){function o(e){return e.replace(/(\[aesop_([a-zA-Z_]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z_]+]|\[aesop_([a-zA-Z_]+)\s?([^\[\]]*)])/g,function(e){return t("aesop-component",e)})}function t(e,o){var t=/\[aesop_([a-zA-Z_]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z_]+]/g,n=/\[aesop_([a-zA-Z_]+)\s?([^\[\]]*)]/g,a=t.exec(o);if(a){var s='<div data-mce-resize="false" data-mce-placeholder="1" data-aesop-sc="'+window.encodeURIComponent(o)+'" class="mceItem aesop-component-long '+e+'"><div class="aesop-component-mask"></div><div class="aesop-component-bar"  contenteditable="false"><div class="aesop-component-controls"><div title="Delete Component" class="aesop-button aesop-button-delete">&nbsp;</div><div title="Edit Component" class="aesop-button aesop-button-edit aesop-scope-'+a[1]+'">&nbsp;</div><div title="Cut/Paste Component" class="aesop-button aesop-button-clipboard">&nbsp;</div></div><span class="mceNonEditable aesop-component-title unselectable aesop-'+a[1]+'-title">'+a[1].replace(/_/g," ")+'</span></div><div class="aesop-component-content aesop-'+a[1]+'"><p>'+a[3]+"</p></div></div>";console.log(s)}else{a=n.exec(o);var s='<div data-mce-resize="false" data-mce-placeholder="1" data-aesop-sc="'+window.encodeURIComponent(o)+'" class="mceItem aesop-component-short '+e+'"><div class="aesop-component-mask"></div><div class="aesop-component-bar" contenteditable="false"><div class="aesop-component-controls"><div title="Delete Component" class="aesop-button aesop-button-delete">&nbsp;</div><div title="Edit Component" class="aesop-button aesop-button-edit aesop-scope-'+a[1]+'">&nbsp;</div><div title="Cut/Paste Component" class="aesop-button aesop-button-clipboard">&nbsp;</div></div><span class="mceNonEditable aesop-component-title unselectable aesop-'+a[1]+'-title">'+a[1].replace(/_/g," ")+'</span></div><div class="aesop-end">WcMgcq</div></div>'}return s}function n(e){return e.replace(/<div[^>]+?class="[^"]+?aesop-component-long.*?aesop-sc="([^"]+)"[\s\S]*?aesop-component-content[^>]*?>(.*?)<\/div>[\s]*?<\/div>|<div class="[^"+]+?aesop-component-short.*?aesop-sc="([^"]+)"[\s\S]*?WcMgcq<\/div><\/div>/g,function(e){return a(e)})}function a(e){var o=/<div[^>]+?class="[^"]+?aesop-component.*?aesop-sc="([^"]+)"[\s\S]*?aesop-component-content[^>]*?>(.*?)<\/div>[\s]*?<\/div>/g,t=/<div class="[^"+]+?aesop-component.*?aesop-sc="([^"]+)"[\s\S]*?WcMgcq<\/div><\/div>/g,n=/<div\s*class="clipboardControl[^>]+?><div\s*class="aesop[^>]+>\s*<\/div><\/div>/g;e=e.replace(n,"");var a=o.exec(e);if(a){var s=window.decodeURIComponent(a[1]),i=/\[[^\]]*\]([^\[]*)[^\]]*\]/,c=i.exec(s);return null!=c&&(s=s.replace(c[1],a[2])),"<p>"+s+"</p>"}if(a=t.exec(e),!a)return e;var s=window.decodeURIComponent(a[1]);return"<p>"+s+"</p>"}function s(e){var o=/\[aesop_([a-zA-Z_]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z]+]/g,t=/\[aesop_([a-zA-Z_]+)\s([^\[\]]*)]/g,n=/<br data-mce-bogus="1">/g,a=/([^\s]+="[^"]+")/g,s=/([^\s]+)\s?/g,i=o.exec(e);if(!i&&(i=t.exec(e),!i))return e;for(var c,d=[];null!==(c=a.exec(i[2]));)d.push(c[1]);var p=[];return d.forEach(function(e){e=e.split("=");var o=e[0],t=e[1];t=t.slice(0,-1),p[o]=t.substring(1)}),"undefined"!=typeof i[3]&&(p.content=i[3].replace(n,"")),p}function i(e){e.parentNode.removeChild(e)}function c(e){"none"!==e.style.display&&(e.style.display="none")}function d(e){"block"!==e.style.display&&(e.style.display="block")}function p(e){var o=timymce.activeEditor.dom.select("."+e)}function r(e){window.clipboardSource=e;var o=tinymce.activeEditor,t=o.dom.create("div",{"class":"clipboardControl mceNonEditable unselectable"},'<div class="aesop-button aesop-button-paste mceNonEditable unselectable" title="Ctrl + Alt + Enter to Paste">&nbsp;</div>');o.getBody().insertBefore(t,o.getBody().firstChild),window.clipboardControl=$(t)}function l(){var e=tinymce.activeEditor,o=e.dom.select(".clipboardControl");e.dom.remove(o),delete window.clipboard,delete window.clipboardSource,delete window.clipboardControl}function v(){var e=window.clipboardSource,o=tinymce.activeEditor;o.dom.remove(e),d(window.clipboard),o.execCommand("mceInsertRawHTML",!1,window.clipboard.outerHTML),l()}e.onClick.add(function(e,o){if(delete window.ailocked,delete window.aiactive,"undefined"!=typeof $(e.selection.getNode()).parents(".aesop-component")[0]&&(window.aiactive=!0),o.target.className.indexOf("aesop-button-delete")>-1){var t=confirm("Are you sure you want to delete this Aesop Component?");t===!0&&o.target.parentNode.parentNode.parentNode.parentNode.removeChild(o.target.parentNode.parentNode.parentNode),delete window.aiactive,window.ailocked=!0,tinymce.execCommand("mceFocus",!1,e.id)}if(o.target.className.indexOf("aesop-button-edit")>-1){var a=/aesop-scope-([a-z_]*)/,i=a.exec(o.target.className),d=o.target.parentNode.parentNode.parentNode,p=n(d.outerHTML);if(d.setAttribute("id","aesop-generator-editing"),i){$("body").toggleClass("modal-open"),$("#aesop-generator-wrap").toggleClass("aesop-generator-open");var l=".dk_options li."+i[1]+" a";$(l).click();var v=s(p);for(var u in v)"content"===u?$("#aesop-generator-content").val(v[u]):$('#aesop-generator-settings [name="'+u+'"]').val(v[u])}}if(o.target.className.indexOf("aesop-button-clipboard")>-1){var d=o.target.parentNode.parentNode.parentNode;window.clipboard=d,c(d),r(d)}}),e.onKeyDown.add(function(e,o){if(delete window.ailocked,13===o.keyCode&&!o.ctrlKey&&!o.shiftKey&&!o.altKey){var t=e.selection.getNode(),n=$(t).parents(".aesop-component");if($(t).parents(".aesop-component")[0]){o.preventDefault(),o.stopPropagation();var a=$("<p><br/></p>").insertAfter(n);a.uniqueId();var s=a.attr("id"),i=e.dom.select("#"+s)[0];e.selection.setCursorLocation(i)}}o.ctrlKey&&o.altKey&&13===o.keyCode&&(o.preventDefault(),o.stopPropagation(),"undefined"==typeof window.clipboard?alert("Clipboard is empty"):"undefined"!=typeof window.aiactive?alert("Please do not paste into an existing aesop component"):v())}),e.onKeyUp.add(function(e,o){"undefined"!=typeof $(e.selection.getNode()).parents(".aesop-component")[0]?window.aiactive=!0:delete window.aiactive}),e.on("BeforeSetContent",function(e){e.content=o(e.content)}),e.on("PostProcess",function(e){e.get&&(e.content=n(e.content))})})}(window.jQuery);
//# sourceMappingURL=./plugin.min.map
>>>>>>> 007c992236cfb4b2f209edb4dd51c0c8b3d2804f
